<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/Bootstrap%205/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="/js/Bootstrap%205/bootstrap.bundle.min.js"></script>
    <script src="/js/JQuery/jquery-3.7.1.js"></script>
    <link href="/css/select2/select2.css" rel="stylesheet"/>
    <script src="/js/select2/select2.min.js"></script>
    <link href="/css/DataTable/jquery.dataTables.css" rel="stylesheet">
    <script src="/js/DataTable/jquery.dataTables.js"></script>
    <link href="/css/user.css" rel="stylesheet" >
    <link href="/css/syllabus/createSyllabusGeneral.css" rel="stylesheet" >
    <link href="/css/syllabus/createSyllabusGeneral.css" rel="stylesheet" >
    <link rel="shortcut icon" type="image/png" href="img/FPT_logo.png"/>
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>

    <title>Document</title>
</head>
<body>
<header class="bg-main text-white px-5 py-1" >
    <div th:replace="~{common :: header}"></div>
</header>

<div class="d-flex flex-grow-1 flex-row">
    <div th:replace="~{common :: menu}"></div>

    <div class="frame-1193">
        <div class="program-header">
            <div class="frame-1191">
                <div class="syllabus">Syllabus</div>
                <div class="progress-bar">
                    <div class="label">
                        <div class="bar">
                            <div class="progress-bar2">
                                <div class="ellipse-offset-to-get-to-the-middle">
                                <div class="ellipse">
                                </div>
                            </div>
                                <div class="spacer"></div>
                            </div>

                        </div>
                        <div class="padding">
                            <div class="text">General</div>
                        </div>
                    </div>
                    <div class="label">
                        <div class="bar2" style="z-index: 99">
                            <div class="progress-bar1">
                            </div>
                            <div class="spacer"></div>
                        </div>
                        <div class="padding">
                            <div class="text">Outline</div>
                        </div>
                    </div>
                    <div class="label">
                        <div class="bar2">
                            <div class="progress-bar1"></div>
                        </div>
                        <div class="padding">
                            <div class="text2">Other</div>
                        </div>
                    </div>
                    <div class="label">
                        <div class="bar3">
                            <div class="progress-bar1"></div>
                        </div>
                        <div class="padding">
                            <div class="text">Done</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="basic-info">
            <div class="syllabus-name-code">
                <div class="req-text-box">
                    <div class="text3">Syllabus Name*</div>
                    <input type="text" id="syllabus-name" name="" value="" class="text-box">
                </div>
                <div class="req-text-box">
                    <div class="text3">Code</div>
                    <div class="npl">NPL</div>
                </div>
                <div class="req-text-box">
                    <div class="text3">Version</div>
                    <div class="_1-0">1.0</div>
                    <input type="hidden" value="1.0" id="version">
                </div>
            </div>
        </div>
        <div class="frame-1196">
            <div class="frame-1192">
                <div class="content">
                    <div class="syllabus-name">
                        <div class="syllabus-tab">
                            <div class="frame-5115">
                                <div class="tab-1">
                                    <div class="general">General</div>
                                </div>
                                <a th:href="@{/createSyllabus}">
                                    <div class="tab-2">
                                        <div class="frame-51">
                                            <div class="tab-22">Outline</div>
                                        </div>
                                    </div>
                                </a>
                                <div class="tab-3">
                                    <div class="frame-51">
                                        <div class="tab-22">Training material</div>
                                    </div>
                                </div>
                            </div>
                            <div class="line-4"></div>
                        </div>
                    </div>
                    <div class="general2">
                        <div class="knowledge-req">
                            <div class="req-text-box2">
                                <div class="text3">Level</div>
                                <div class="dropdown-box">
                                    <select id="level" name="colors" class="combo-box" style="border: none; outline: none; transition: .5s ease">
                                        <option value="BEGINNER" style="font-size: .8em">BEGINNER</option>
                                        <option value="ADVANCED" style="font-size: .8em">ADVANCED</option>
                                        <option value="" style="font-size: .8em">ALL_LEVEL</option>
                                    </select>
                                </div>
                            </div>
                            <div class="req-text-box3">
                                <div class="text3">Attendee number</div>
                                <div class="input2">
                                    <input type="number" name="" id="attendee-number" style="width: 100%; border: none; outline: none">
                                    <input type="hidden" value="2" id="userid">
                                </div>
                            </div>
                        </div>
                        <div class="tech-req">
                            <div class="req-text-box4">
                                <div class="text3">Technical Requirement(s)</div>
                                <textarea id="tech-reqs" class="scrollable-textarea"></textarea>
                            </div>
                        </div>
                        <div class="objectives">
                            <div class="req-text-box4">
                                <div class="req-text-box3">
                                    <div class="text3">Course Objectives</div>
                                    <div class="input2 course" style="position:relative;">
                                        <input type="text" name="" id="LearningObjectiveName" style="width: 100%; border: none; outline: none" onblur="showPlaceholder()" onfocus="hidePlaceholder()">
                                        <p id="placeholderText" style="white-space: nowrap;">Course Objective Name</p>
                                    </div>
                                </div>
                                <textarea id="course-obj" class="scrollable-textarea" name="textarea"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="frame-1190">
                    <div class="basic-info2">
                        <div class="syllabus-name-code2">
                            <div class="version"></div>
                        </div>
                    </div>
                    <div class="frame-11902">
                        <div class="time-allocation">
                            <div class="time-allocation2">Time allocation</div>
                        </div>
                        <div class="content2">
                            <div class="doughnut">
                                <div class="_01"></div>
                                <div class="_02"></div>
                                <div class="_03"></div>
                                <div class="_04"></div>
                            </div>
                            <div class="info">
                                <div class="frame-108">
                                    <div class="bullet">
                                        <div class="rectangle-644"></div>
                                    </div>
                                    <div class="frame-5116">
                                        <div class="assignment-lab">Assignment/Lab</div>
                                        <div class="_54">(54%)</div>
                                    </div>
                                </div>
                                <div class="frame-113">
                                    <div class="bullet">
                                        <div class="rectangle-6442"></div>
                                    </div>
                                    <div class="frame-51162">
                                        <div class="concept-lecture">Concept/Lecture</div>
                                        <div class="_29">(29%)</div>
                                    </div>
                                </div>
                                <div class="frame-114">
                                    <div class="bullet">
                                        <div class="rectangle-6443"></div>
                                    </div>
                                    <div class="frame-51162">
                                        <div class="guide-review">Guide/Review</div>
                                        <div class="_9">(9%)</div>
                                    </div>
                                </div>
                                <div class="frame-115">
                                    <div class="bullet">
                                        <div class="rectangle-6444"></div>
                                    </div>
                                    <div class="frame-51162">
                                        <div class="test-quiz">Test/Quiz</div>
                                        <div class="_1">(1%)</div>
                                    </div>
                                </div>
                                <div class="frame-116">
                                    <div class="bullet">
                                        <div class="rectangle-6445"></div>
                                    </div>
                                    <div class="frame-51162">
                                        <div class="exam">Exam</div>
                                        <div class="_6">(6%)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="frame-5119">
                <div class="button" style="cursor: pointer">
                    <div class="filter cancel-btn">Cancel</div>
                </div>
                <div class="button2">
                    <div class="filter2">Save as draft</div>
                </div>
                        <a style="text-decoration: none; color: #eeecec; user-select: none; cursor: pointer">
                            <div class="filter2 save-btn">
                            Next
                            </div>
                        </a>
            </div>
        </div>
    </div>

</div>

<div th:replace="~{common :: footer}"></div>

<script src="/js/common.js"></script>
<script src="/js/tinymce/script.js"></script>
<script src="/js/tinymce/tinymce.min.js"></script>

<script>
    function hidePlaceholder() {
        const placeholderText = document.getElementById("placeholderText");
        placeholderText.style.display = "none";
    }

    function showPlaceholder() {
        const inputElement = document.getElementById("LearningObjectiveName");
        if (inputElement.value === "") {
            const placeholderText = document.getElementById("placeholderText");
            placeholderText.style.display = "block";
        }
    }
</script>

<script>
        $(document).ready(function () {
            $('.save-btn').click(function (e) {
                if(areAllFieldFilled()){
                    localStorage.clear();
                    createSyllabusGeneral();
                    setTimeout(() => {
                        window.location.href = "http://localhost:8081/createSyllabus";
                    }, 600);

                    console.log("click");
                } else {
                    alert("All fields are required!");
                    e.preventDefault();
                }
            });

            $('.cancel-btn').click(function (e) {
                clearAllFields();
            });
        })

        function areAllFieldFilled(){
            var requiredFields = [
                $('#syllabus-name'),
                $('#tech-reqs'),
                $('#course-obj'),
                $('#attendee-number')
            ];
            var allFieldsFilled = true;
            requiredFields.forEach(function (field) {
                if (field.val().trim() === '') {
                    allFieldsFilled = false;
                    return false;
                }
            });

            return allFieldsFilled;

        }

        function clearAllFields(){
            var requiredFields = [
                $('#syllabus-name'),
                $('#tech-reqs'),
                $('#course-obj'),
                $('#attendee-number')
            ];
            for (var i = 0; i < requiredFields.length; i++) {
                requiredFields[i].val('');
            }
        }
        function createSyllabusGeneral() {
            var combo = document.getElementById("level");
            combo.selectedIndex = 0;
            var level1 = combo.value;

            var syllabusName = document.getElementById("syllabus-name").value;
            var attendeeNumber = document.getElementById("attendee-number").value;
            var textareaElement1 = document.getElementById("tech-reqs");
            var textareaValue1 = textareaElement1.value;
            var textareaElement2 = document.getElementById("course-obj");
            var textareaValue2 = textareaElement2.value;
            var userid1 = document.getElementById("userid").value;
            var learningObjname = document.getElementById("LearningObjectiveName").value;
            var version1 = document.getElementById("version").value;
            var data = {
                topicName: syllabusName,
                trainingAudience: attendeeNumber,
                level: level1,
                technicalGroup: textareaValue1,
                description: textareaValue2,
                userID: userid1,
                learningObjectiveName: learningObjname,
                version: version1,
            };
            console.log(data.level);
            // Sử dụng $.ajax để gửi POST request
            $.ajax({
                url: 'http://localhost:8080/api/v1/syllabus/create-general-syllabus',
                type: 'POST',
                data: JSON.stringify(data),
                contentType: 'application/json',
                success: function (response) {
                    console.log('Syllabus created:', response.topicCode);
                    localStorage.clear();
                    localStorage.setItem("topicCode",response.topicCode)
                },
                error: function (err) {
                    console.error('Ngooooo:', err);
                }
            });
        };
</script>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</body>

</html>